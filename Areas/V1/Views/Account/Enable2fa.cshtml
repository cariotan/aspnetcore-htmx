@model Enable2faModel

<div class='fixed inset-0'>
	<div class='flex justify-center items-center min-h-full'>
		<div class='mx-auto rounded-xl w-full max-w-md bg-white p-6'>
			<h2 class='mb-4 text-xl text-gray-900 font-bold'>
				Set up twoâ€‘factor authentication
			</h2>
			<p class='mb-6 text-sm text-gray-600'>
				Scan the QR code below or use the enable_2fa_key provided to configure your authenticator app.
			</p>
			<div class='mb-6 flex justify-center'>
				<img
					src='data:image/png;base64,@Model?.QrBase64'
					alt='QR Code'
					class='rounded-lg border border-gray-300 w-48 h-48 bg-white p-2 shadow'
				/>
			</div>
			<div class='mb-4'>
				<label class='block mb-1 text-sm text-gray-900 font-medium'>
					Setup Key
				</label>
				<div
					x-data='{
						enable_2fa_key: "@Model?.AuthenticatorKey"
					}'
					class='flex'
				>
					<span
						x-text='enable_2fa_key'
						class='rounded-l-md border border-gray-300 flex-1 bg-gray-50 px-3 py-2 text-sm text-gray-800'
					></span>
					<button 
						x-on:click='navigator.clipboard.writeText(enable_2fa_key)'
						class='rounded-r-md border border-gray-300 border-l-0 bg-white px-3 py-2 text-sm text-gray-700 hover:bg-gray-50'
					>
						Copy
					</button>
				</div>
			</div>
			<form
				id='code-form'
				asp-action='Enable2fa'
				x-data='{
					enable2fa_buttonSpinner:
					{
						isLoading: false,
					},
				}'
				x-on:submit='enable2fa_buttonSpinner.isLoading = true'
			>
				<div class='mb-6'>
					<label class='block mb-1 text-sm text-gray-900 font-medium'>
						Enter 6-digit code
					</label>
					<input
						type='text'
						name='code'
						class='rounded-md border border-gray-300 w-full px-3 py-2 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-600 focus:border-indigo-600'
					>
					@Html.ValidationMessage("code")
				</div>
				<div class='flex gap-3'>
					<button
						type='submit'
						class='rounded-md flex-1 bg-indigo-600 px-3 py-2 text-white font-semibold hover:bg-indigo-500'
					>
						<partial name='_ButtonSpinner' model='"enable2fa_buttonSpinner"' />
						<span x-opacity='!enable2fa_buttonSpinner.isLoading'>
							Verify & Enable
						</span>
					</button>
					<a
						href='/'
						asp-action='Index'
						asp-controller='Home'
						class='rounded-md flex flex-1 justify-center items-center bg-gray-100 px-3 py-2 text-gray-800 font-medium hover:bg-gray-200'
					>
						Skip
					</a>
				</div>
			</form>
		</div>
	</div>
</div>